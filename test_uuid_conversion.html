<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Conversão UUID → BIGINT</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .result {
            background: #f0f0f0;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .success { background: #d4edda; }
        .error { background: #f8d7da; }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Teste de Conversão UUID → BIGINT</h1>
    
    <div>
        <label>UUID (do auth.users):</label><br>
        <input type="text" id="uuid" value="ea40e459-b1d0-45ee-9d5f-adc51b44dc50" style="width: 100%; padding: 5px;">
    </div>
    
    <div style="margin-top: 10px;">
        <label>ID Esperado (do banco):</label><br>
        <input type="text" id="expectedId" value="799003603834504413" style="width: 100%; padding: 5px;">
    </div>
    
    <button onclick="testConversion()" style="margin-top: 15px;">Testar Conversão</button>
    
    <div id="results"></div>

    <script>
        function uuidToBigint(uuid) {
            const hex = uuid.replace(/-/g, '').substring(0, 15);
            const bigIntValue = BigInt('0x' + hex);
            return bigIntValue.toString();
        }

        function testConversion() {
            const uuid = document.getElementById('uuid').value;
            const expectedId = document.getElementById('expectedId').value;
            
            const converted = uuidToBigint(uuid);
            const match = converted === expectedId;
            
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `
                <div class="result ${match ? 'success' : 'error'}">
                    <h3>Resultado:</h3>
                    <p><strong>UUID Original:</strong> ${uuid}</p>
                    <p><strong>UUID sem hífens:</strong> ${uuid.replace(/-/g, '')}</p>
                    <p><strong>Primeiros 15 chars:</strong> ${uuid.replace(/-/g, '').substring(0, 15)}</p>
                    <p><strong>Convertido para BIGINT:</strong> ${converted}</p>
                    <p><strong>ID Esperado:</strong> ${expectedId}</p>
                    <p><strong>Status:</strong> ${match ? '✅ CORRETO' : '❌ DIFERENTE'}</p>
                    ${!match ? `<p style="color: red;"><strong>Diferença:</strong> ${BigInt(converted) - BigInt(expectedId)}</p>` : ''}
                </div>
            `;
        }
        
        // Testar automaticamente ao carregar
        window.onload = testConversion;
    </script>
</body>
</html>
